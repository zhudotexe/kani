POST https://api.anthropic.com/v1/messages/count_tokens
accept: application/json
content-type: application/json
x-api-key: *** REDACTED ***

{"messages":[{"role":"user","content":[{"type":"text","text":"Find all users in San Francisco and tell me their names and total order amounts."}]},{"role":"assistant","content":[{"type":"tool_use","id":"toolu_01WxW1jSUQKQkJP7um9QRuML","name":"search_users","input":{"city":"San Francisco"}}]},{"role":"user","content":[{"type":"tool_result","tool_use_id":"toolu_01WxW1jSUQKQkJP7um9QRuML","content":"[{'id': 1, 'name': 'Alice'}]"}]}],"model":"claude-haiku-4-5","system":"You are a database assistant. Use the provided functions to answer questions about users and orders.","tools":[{"name":"get_order_total","description":"Calculate the total amount spent by a user.","input_schema":{"description":"Calculate the total amount spent by a user.","properties":{"user_id":{"type":"integer"}},"required":["user_id"],"title":"get_order_total","type":"object"}},{"name":"get_user_orders","description":"Get all orders for a specific user ID.","input_schema":{"description":"Get all orders for a specific user ID.","properties":{"user_id":{"type":"integer"}},"required":["user_id"],"title":"get_user_orders","type":"object"}},{"name":"search_users","description":"Search for users by city.","input_schema":{"description":"Search for users by city.","properties":{"city":{"type":"string"}},"required":["city"],"title":"search_users","type":"object"}}]}