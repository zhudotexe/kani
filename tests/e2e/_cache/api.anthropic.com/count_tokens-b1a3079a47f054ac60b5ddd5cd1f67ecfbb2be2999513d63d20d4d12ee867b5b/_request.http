POST https://api.anthropic.com/v1/messages/count_tokens
accept: application/json
content-type: application/json
x-api-key: *** REDACTED ***

{"messages":[{"role":"user","content":[{"type":"text","text":"What time is it?"}]},{"role":"assistant","content":[{"type":"tool_use","id":"toolu_019a8j1c9JxXNaSsyXfDQCRL","name":"get_time","input":{}}]},{"role":"user","content":[{"type":"tool_result","tool_use_id":"toolu_019a8j1c9JxXNaSsyXfDQCRL","content":"CUSTOM ERROR HANDLER: The function get_time failed with error: The time API is currently offline (error 0xDEADBEEF).. Please inform the user about this error.","is_error":true}]}],"model":"claude-haiku-4-5","system":"You are a helpful assistant. Use the provided functions to answer questions.","tools":[{"name":"get_time","description":"Get the current time in the user's time zone.","input_schema":{"description":"Get the current time in the user's time zone.","properties":{},"title":"get_time","type":"object"}},{"name":"working_function","description":"A function that works correctly.","input_schema":{"description":"A function that works correctly.","properties":{},"title":"working_function","type":"object"}}]}