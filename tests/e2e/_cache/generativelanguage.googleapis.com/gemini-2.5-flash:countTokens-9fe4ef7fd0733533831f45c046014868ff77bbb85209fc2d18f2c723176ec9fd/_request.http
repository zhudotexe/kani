POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:countTokens
accept: */*
content-type: application/json
x-goog-api-key: *** REDACTED ***

{"contents": [{"parts": [{"text": "Call the flaky_function with x=42. Retry if it fails, it should eventually work."}], "role": "user"}, {"parts": [{"thoughtSignature": "CqwEAdHtim_cJ-eZRS2D9XEtwpzBggc-4q6_dN8WiVM0DVJCCzS663DJNRL7GWlSoapV2uGM64M6s2TnZbrGw41WFuyc375hgL3Gw0IlA4mkMro_VK2vxso8vvBqqiNIXwq5A2SEP7HNxzLdObQTbbnqEkkgAixbSUQzp_MJCwMyk8tdB5eOXBbOIqWA_OLoCFoZbiFAVDL1jJzW_NYe83m0aGuh_ohAVxaXE6OU8J7bjNO5brJXgWGy6wPVAxxIt5TDwiC8hBJQS8uJJ3VZq_ZdMqVmC-0wwzpvJukpOegIvIFZtccPHlyBfLROw1XlrCXpb4dJu0i73RFdrBQnz0G07lWZPk8pdv7AeZrVcNRQriAYlbaBXD3FxFayhxtddwoH9XXwsp9iMOqODctHZhLcwv8SaMwUwWEf8eEtd4CCIsbWeL7SH-E2KbVMfROu3Lm2pjxZTlaFXyQHU0O67ClkUekc9qrDBjh6C8UTtFuZ7sBQu4I-8jc8zJQazYzQUl5bo-62AruyktcijOhNFNzCnTm1E4ctguY3KFXhx1GnnmwrXyqI1tAE2-dORj3Q4eWQma0EAR0WlftLOE7zzgEiVU9ZLGjotSutJq6PLZ8PXitMcCC1h-7kulMesJBcqjIf7uQ9swSxST_2BFE89zgT3l0iJE2j9FxTK7PmwMPa70rIyTjsNaCDACfTpAzY2-ee5Of1I2GHBqnqIPffPzF5iLvrBe7a870DHyxMFA==", "functionCall": {"args": {"x": 42}, "name": "flaky_function"}}], "role": "model"}, {"parts": [{"functionResponse": {"id": "bdd640fb-0667-4ad1-9c80-317fa3b1799d", "name": "flaky_function", "response": {"error": "First call always fails!"}}}], "role": "tool"}, {"parts": [{"thoughtSignature": "CoACAdHtim-O4_DyGAy0B2nea9-G29gp_iUHa_36sH_Slji2FVrpDXF1jLzHWuFICd_bbewCzie2XyqapWpQbDxb3N50p09bLWX6ziv_F-wiEb-U0QmDIJtq04ucSUJCHWWSY9sRG8SexSIyBWZB8NDNjMP-i88vEShZVQXbejjhmWSPpWlaeh7qgdBbjeLTghADn_c6UsmIUeZ6xjjp1TGEsOl2fpuvR6sUKSTvUfaRBbmL2HyjrWLcss2E2LEjvBtmXO8PvtdxnqwoP2qwDvvrMQzGwBQ9d5vX0ynasx_Q_2Gvb2rvKmE2yF6SaOcD2aAYYWoXmoyM8Jpmu2i7oy-AeA==", "functionCall": {"args": {"x": 42}, "name": "flaky_function"}}], "role": "model"}, {"parts": [{"functionResponse": {"id": "23b8c1e9-3924-46de-beb1-3b9046685257", "name": "flaky_function", "response": {"result": "Success! x = 42"}}}], "role": "tool"}]}